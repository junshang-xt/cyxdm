<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æµªæ¼«èŠ±å›­ - æˆ‘ä»¬çš„çˆ±æƒ…èŠ±å›­</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #f5d6d6 0%, #d6f5e0 100%);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }
        
        /* èƒŒæ™¯è£…é¥° */
        .bg-decoration {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            opacity: 0.4;
        }
        
        .cloud {
            position: absolute;
            background: white;
            border-radius: 50%;
            animation: float 30s linear infinite;
        }
        
        .cloud-1 {
            width: 100px;
            height: 60px;
            top: 10%;
            left: -10%;
            animation-duration: 90s;
        }
        
        .cloud-2 {
            width: 150px;
            height: 80px;
            top: 20%;
            left: -15%;
            animation-duration: 120s;
            animation-delay: 20s;
        }
        
        .cloud-3 {
            width: 120px;
            height: 70px;
            top: 5%;
            left: -12%;
            animation-duration: 100s;
            animation-delay: 10s;
        }
        
        @keyframes float {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(2000px); }
        }
        
        /* ä¸»å®¹å™¨ */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* æ ‡é¢˜æ ·å¼ */
        .title-section {
            text-align: center;
            margin-bottom: 40px;
            padding-top: 30px;
        }
        
        .main-title {
            font-size: 3rem;
            color: #ff6b81;
            text-shadow: 3px 3px 0px rgba(255, 107, 129, 0.2);
            margin-bottom: 10px;
            animation: pulse 2s infinite;
        }
        
        .subtitle {
            font-size: 1.2rem;
            color: #5f27cd;
            margin-bottom: 20px;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        /* èŠ±å›­åŒºåŸŸ */
        .garden-container {
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><rect width="100" height="100" fill="%2391c788" fill-opacity="0.5"/><path d="M0,0 L100,100 M100,0 L0,100" stroke="%2374a765" stroke-opacity="0.3" stroke-width="1"/></svg>');
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            position: relative;
            min-height: 500px;
            overflow: hidden;
        }
        
        /* èŠ±å›­ç½‘æ ¼ */
        .garden-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 10px;
            margin-bottom: 30px;
        }
        
        .garden-cell {
            width: 100%;
            aspect-ratio: 1;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .garden-cell:hover {
            background: rgba(255, 255, 255, 0.5);
            transform: scale(1.05);
        }
        
        .garden-cell.planted {
            cursor: default;
        }
        
        /* èŠ±æœµæ ·å¼ */
        .flower {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 60%;
            height: 60%;
            transition: all 0.5s ease;
        }
        
        .flower:hover {
            transform: translate(-50%, -50%) scale(1.2) rotate(5deg);
        }
        
        .flower-core {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            border-radius: 50%;
            z-index: 2;
        }
        
        .flower-petal {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 30%;
            height: 30%;
            border-radius: 50%;
            z-index: 1;
            transform-origin: 50% 50%;
        }
        
        .flower-stem {
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 8%;
            height: 50%;
            z-index: 0;
        }
        
        /* å·¥å…·é¢æ¿ */
        .tool-panel {
            background: rgba(255, 255, 255, 0.8);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .tool-button {
            background: linear-gradient(45deg, #ff9ff3, #54a0ff);
            border: none;
            border-radius: 50px;
            padding: 10px 20px;
            color: white;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }
        
        .tool-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.15);
        }
        
        .tool-button.active {
            background: linear-gradient(45deg, #54a0ff, #ff9ff3);
            transform: translateY(-2px);
        }
        
        /* çŠ¶æ€é¢æ¿ */
        .status-panel {
            background: rgba(255, 255, 255, 0.8);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .status-text {
            font-size: 1.1rem;
            color: #5f27cd;
            margin-bottom: 10px;
        }
        
        .love-points {
            font-size: 1.5rem;
            font-weight: bold;
            color: #ff6b81;
            animation: glow 1.5s ease-in-out infinite alternate;
        }
        
        @keyframes glow {
            from { text-shadow: 0 0 5px #ff6b81; }
            to { text-shadow: 0 0 20px #ff6b81, 0 0 30px #ff6b81, 0 0 40px #ff6b81; }
        }
        
        /* çˆ±çš„ç•™è¨€æ¿ */
        .message-board {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .message-title {
            font-size: 1.5rem;
            color: #ff6b81;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .message-input {
            width: 100%;
            padding: 15px;
            border: 2px solid #ffd1d1;
            border-radius: 10px;
            font-size: 1rem;
            resize: none;
            margin-bottom: 15px;
        }
        
        .message-input:focus {
            outline: none;
            border-color: #ff6b81;
        }
        
        .submit-message {
            background: linear-gradient(45deg, #ff6b81, #ff9ff3);
            border: none;
            border-radius: 50px;
            padding: 12px 30px;
            color: white;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: block;
            margin: 0 auto;
        }
        
        .submit-message:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.15);
        }
        
        .message-list {
            margin-top: 20px;
        }
        
        .message-item {
            background: #fff5f5;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 10px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
            animation: slideIn 0.5s ease;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* è¿”å›æŒ‰é’® */
        .back-button {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: linear-gradient(45deg, #54a0ff, #5f27cd);
            border: none;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            z-index: 100;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .back-button:hover {
            transform: translateY(-5px) scale(1.1);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.25);
        }
        
        /* æˆå°±å¼¹çª— */
        .achievement-modal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            z-index: 1000;
            animation: modalAppear 0.5s ease;
        }
        
        @keyframes modalAppear {
            from {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.8);
            }
            to {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
            }
        }
        
        .achievement-icon {
            font-size: 3rem;
            color: #ffd700;
            margin-bottom: 15px;
        }
        
        .achievement-title {
            font-size: 1.8rem;
            color: #ff6b81;
            margin-bottom: 10px;
        }
        
        .achievement-description {
            font-size: 1.1rem;
            color: #5f27cd;
            margin-bottom: 20px;
        }
        
        .achievement-close {
            background: linear-gradient(45deg, #ff6b81, #ff9ff3);
            border: none;
            border-radius: 50px;
            padding: 10px 25px;
            color: white;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .achievement-close:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.15);
        }
        
        /* çˆ±å¿ƒé›¨æ•ˆæœ */
        .heart {
            position: fixed;
            top: -10%;
            transform: translateY(0);
            animation: fall linear forwards;
            z-index: 99;
        }
        
        @keyframes fall {
            to {
                transform: translateY(110vh);
            }
        }
        
        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .main-title {
                font-size: 2rem;
            }
            
            .subtitle {
                font-size: 1rem;
            }
            
            .garden-container {
                padding: 20px;
            }
            
            .garden-grid {
                grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
                gap: 8px;
            }
            
            .back-button {
                bottom: 20px;
                right: 20px;
                width: 50px;
                height: 50px;
                font-size: 1.2rem;
            }
        }
        
        @media (max-width: 480px) {
            .main-title {
                font-size: 1.8rem;
            }
            
            .garden-grid {
                grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
                gap: 5px;
            }
            
            .tool-button {
                padding: 8px 15px;
                font-size: 0.9rem;
            }
            
            .achievement-modal {
                width: 90%;
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <!-- èƒŒæ™¯è£…é¥° -->
    <div class="bg-decoration">
        <div class="cloud cloud-1"></div>
        <div class="cloud cloud-2"></div>
        <div class="cloud cloud-3"></div>
    </div>
    
    <!-- ä¸»å®¹å™¨ -->
    <div class="container">
        <!-- æ ‡é¢˜éƒ¨åˆ† -->
        <div class="title-section">
            <h1 class="main-title">æµªæ¼«èŠ±å›­</h1>
            <p class="subtitle">åœ¨è¿™ç‰‡èŠ±å›­é‡Œï¼Œç§ä¸‹æˆ‘ä»¬çš„çˆ±æƒ…ä¹‹èŠ±ï¼Œè®©å®ƒèŒå£®æˆé•¿</p>
        </div>
        
        <!-- çŠ¶æ€é¢æ¿ -->
        <div class="status-panel">
            <p class="status-text">ç²¾å¿ƒç…§æ–™ä½ çš„èŠ±å›­ï¼Œè®©çˆ±æƒ…ä¹‹èŠ±ç»½æ”¾</p>
            <p class="love-points">çˆ±æƒ…æŒ‡æ•°: <span id="lovePoints">0</span></p>
        </div>
        
        <!-- å·¥å…·é¢æ¿ -->
        <div class="tool-panel">
            <button class="tool-button" id="plantFlower">ç§æ¤èŠ±æœµ</button>
            <button class="tool-button" id="waterFlower">æµ‡æ°´ (æ¢å¤ç”Ÿæœº)</button>
            <button class="tool-button" id="fertilizeFlower">æ–½è‚¥ (åŠ é€Ÿç”Ÿé•¿)</button>
            <button class="tool-button" id="removeFlower">ç§»é™¤èŠ±æœµ</button>
        </div>
        
        <!-- èŠ±å›­åŒºåŸŸ -->
        <div class="garden-container">
            <div class="garden-grid" id="gardenGrid">
                <!-- èŠ±å›­æ ¼å­å°†ç”±JavaScriptåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>
        
        <!-- çˆ±çš„ç•™è¨€æ¿ -->
        <div class="message-board">
            <h2 class="message-title">çˆ±çš„ç•™è¨€æ¿</h2>
            <textarea class="message-input" id="messageInput" rows="4" placeholder="åœ¨è¿™é‡Œå†™ä¸‹ä½ æƒ³å¯¹TAè¯´çš„è¯..."></textarea>
            <button class="submit-message" id="submitMessage">ç§ä¸‹çˆ±çš„ç•™è¨€</button>
            <div class="message-list" id="messageList">
                <!-- ç•™è¨€å°†ç”±JavaScriptåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>
    </div>
    
    <!-- è¿”å›æŒ‰é’® -->
    <button class="back-button" id="backButton">â†©</button>
    
    <!-- æˆå°±å¼¹çª— -->
    <div class="achievement-modal" id="achievementModal">
        <div class="achievement-icon">ğŸ†</div>
        <h3 class="achievement-title" id="achievementTitle">æ–°æˆå°±ï¼</h3>
        <p class="achievement-description" id="achievementDescription">æ­å–œä½ è·å¾—äº†æ–°æˆå°±</p>
        <button class="achievement-close" id="achievementClose">å¤ªæ£’äº†ï¼</button>
    </div>
    
    <script>
        // å…¨å±€å˜é‡
        let currentTool = 'plantFlower';
        let lovePoints = 0;
        let plantedFlowers = 0;
        let messageCount = 0;
        const gardenSize = 25; // 5x5 ç½‘æ ¼
        const flowerTypes = [
            { color: '#ff6b81', coreColor: '#ff9ff3', stemColor: '#1dd1a1' }, // ç²‰è‰²
            { color: '#54a0ff', coreColor: '#5f27cd', stemColor: '#10ac84' }, // è“è‰²
            { color: '#ff9f43', coreColor: '#ff6348', stemColor: '#00d2d3' }, // æ©™è‰²
            { color: '#10ac84', coreColor: '#54a0ff', stemColor: '#54a0ff' }, // ç»¿è‰²
            { color: '#ff6348', coreColor: '#ff9f43', stemColor: '#10ac84' }  // çº¢è‰²
        ];
        
        // DOM å…ƒç´ 
        const gardenGrid = document.getElementById('gardenGrid');
        const lovePointsElement = document.getElementById('lovePoints');
        const toolButtons = document.querySelectorAll('.tool-button');
        const messageInput = document.getElementById('messageInput');
        const messageList = document.getElementById('messageList');
        const submitMessageButton = document.getElementById('submitMessage');
        const backButton = document.getElementById('backButton');
        const achievementModal = document.getElementById('achievementModal');
        const achievementTitle = document.getElementById('achievementTitle');
        const achievementDescription = document.getElementById('achievementDescription');
        const achievementClose = document.getElementById('achievementClose');
        
        // åˆå§‹åŒ–èŠ±å›­
        function initGarden() {
            for (let i = 0; i < gardenSize; i++) {
                const cell = document.createElement('div');
                cell.classList.add('garden-cell');
                cell.dataset.index = i;
                cell.addEventListener('click', handleCellClick);
                gardenGrid.appendChild(cell);
            }
        }
        
        // å¤„ç†å•å…ƒæ ¼ç‚¹å‡»
        function handleCellClick(event) {
            const cell = event.currentTarget;
            
            switch (currentTool) {
                case 'plantFlower':
                    if (!cell.classList.contains('planted')) {
                        plantFlower(cell);
                    }
                    break;
                case 'waterFlower':
                    if (cell.classList.contains('planted')) {
                        waterFlower(cell);
                    }
                    break;
                case 'fertilizeFlower':
                    if (cell.classList.contains('planted')) {
                        fertilizeFlower(cell);
                    }
                    break;
                case 'removeFlower':
                    if (cell.classList.contains('planted')) {
                        removeFlower(cell);
                    }
                    break;
            }
        }
        
        // ç§æ¤èŠ±æœµ
        function plantFlower(cell) {
            // éšæœºé€‰æ‹©èŠ±æœµç±»å‹
            const flowerType = flowerTypes[Math.floor(Math.random() * flowerTypes.length)];
            
            // åˆ›å»ºèŠ±æœµå…ƒç´ 
            const flower = document.createElement('div');
            flower.classList.add('flower');
            flower.dataset.type = Math.floor(Math.random() * flowerTypes.length);
            
            // åˆ›å»ºèŠ±èŒ
            const stem = document.createElement('div');
            stem.classList.add('flower-stem');
            stem.style.backgroundColor = flowerType.stemColor;
            
            // åˆ›å»ºèŠ±èŠ¯
            const core = document.createElement('div');
            core.classList.add('flower-core');
            core.style.backgroundColor = flowerType.coreColor;
            core.style.width = '30%';
            core.style.height = '30%';
            
            // åˆ›å»ºèŠ±ç“£ï¼ˆ6ä¸ªèŠ±ç“£ï¼‰
            const petals = [];
            for (let i = 0; i < 6; i++) {
                const petal = document.createElement('div');
                petal.classList.add('flower-petal');
                petal.style.backgroundColor = flowerType.color;
                
                // è®¾ç½®èŠ±ç“£ä½ç½®
                const angle = (i / 6) * Math.PI * 2;
                const distance = 40; // è·ç¦»ä¸­å¿ƒçš„è·ç¦»
                petal.style.transform = `translate(-50%, -50%) rotate(${angle}rad) translateY(-${distance}%)`;
                
                petals.push(petal);
            }
            
            // ç»„è£…èŠ±æœµ
            flower.appendChild(stem);
            flower.appendChild(core);
            petals.forEach(petal => flower.appendChild(petal));
            
            // æ·»åŠ åˆ°å•å…ƒæ ¼
            cell.appendChild(flower);
            cell.classList.add('planted');
            
            // æ›´æ–°çŠ¶æ€
            plantedFlowers++;
            addLovePoints(10);
            
            // åˆ›å»ºçˆ±å¿ƒé›¨æ•ˆæœ
            createHeartRain(5);
            
            // æ£€æŸ¥æˆå°±
            checkAchievements();
        }
        
        // ç»™èŠ±æœµæµ‡æ°´
        function waterFlower(cell) {
            const flower = cell.querySelector('.flower');
            if (flower) {
                // åˆ›å»ºæ°´æ»´åŠ¨ç”»
                const waterDrop = document.createElement('div');
                waterDrop.style.position = 'absolute';
                waterDrop.style.width = '10px';
                waterDrop.style.height = '10px';
                waterDrop.style.backgroundColor = 'rgba(84, 160, 255, 0.6)';
                waterDrop.style.borderRadius = '50%';
                waterDrop.style.top = '10%';
                waterDrop.style.left = `${Math.random() * 80 + 10}%`;
                waterDrop.style.animation = 'dropWater 1s ease forwards';
                waterDrop.style.zIndex = '10';
                cell.appendChild(waterDrop);
                
                // æ·»åŠ æ°´æ»´åŠ¨ç”»æ ·å¼
                const style = document.createElement('style');
                style.textContent = `
                    @keyframes dropWater {
                        to {
                            transform: translateY(100px);
                            opacity: 0;
                        }
                    }
                `;
                document.head.appendChild(style);
                
                // æ›´æ–°çŠ¶æ€
                flower.style.transform = 'translate(-50%, -50%) scale(1.1)';
                setTimeout(() => {
                    flower.style.transform = 'translate(-50%, -50%) scale(1)';
                }, 500);
                
                addLovePoints(2);
                
                // ç§»é™¤æ°´æ»´å…ƒç´ 
                setTimeout(() => {
                    cell.removeChild(waterDrop);
                    document.head.removeChild(style);
                }, 1000);
            }
        }
        
        // ç»™èŠ±æœµæ–½è‚¥
        function fertilizeFlower(cell) {
            const flower = cell.querySelector('.flower');
            if (flower) {
                // åˆ›å»ºç”Ÿé•¿åŠ¨ç”»
                flower.style.transition = 'all 1s ease';
                flower.style.transform = 'translate(-50%, -50%) scale(1.2)';
                
                // æ”¹å˜èŠ±æœµé¢œè‰²ï¼ˆç¨å¾®æ·±ä¸€ç‚¹ï¼‰
                const petals = flower.querySelectorAll('.flower-petal');
                const core = flower.querySelector('.flower-core');
                
                petals.forEach(petal => {
                    const currentColor = petal.style.backgroundColor;
                    petal.style.backgroundColor = darkenColor(currentColor, 10);
                });
                
                core.style.backgroundColor = darkenColor(core.style.backgroundColor, 10);
                
                // æ›´æ–°çŠ¶æ€
                addLovePoints(5);
                
                // æ¢å¤åŸå§‹å¤§å°
                setTimeout(() => {
                    flower.style.transform = 'translate(-50%, -50%) scale(1)';
                }, 1000);
            }
        }
        
        // ç§»é™¤èŠ±æœµ
        function removeFlower(cell) {
            const flower = cell.querySelector('.flower');
            if (flower) {
                // æ·»åŠ æ·¡å‡ºåŠ¨ç”»
                flower.style.transition = 'all 0.5s ease';
                flower.style.opacity = '0';
                flower.style.transform = 'translate(-50%, -50%) scale(0.5)';
                
                // æ›´æ–°çŠ¶æ€
                setTimeout(() => {
                    cell.removeChild(flower);
                    cell.classList.remove('planted');
                    plantedFlowers--;
                    addLovePoints(-3); // ç§»é™¤èŠ±æœµä¼šå‡å°‘ä¸€äº›çˆ±æƒ…æŒ‡æ•°
                }, 500);
            }
        }
        
        // æäº¤ç•™è¨€
        function submitMessage() {
            const message = messageInput.value.trim();
            if (message) {
                // åˆ›å»ºç•™è¨€å…ƒç´ 
                const messageItem = document.createElement('div');
                messageItem.classList.add('message-item');
                messageItem.textContent = message;
                
                // æ·»åŠ åˆ°ç•™è¨€æ¿
                messageList.insertBefore(messageItem, messageList.firstChild);
                
                // æ¸…ç©ºè¾“å…¥æ¡†
                messageInput.value = '';
                
                // æ›´æ–°çŠ¶æ€
                messageCount++;
                addLovePoints(15);
                
                // åˆ›å»ºçˆ±å¿ƒé›¨æ•ˆæœ
                createHeartRain(8);
                
                // æ£€æŸ¥æˆå°±
                checkAchievements();
            }
        }
        
        // æ·»åŠ çˆ±æƒ…æŒ‡æ•°
        function addLovePoints(points) {
            lovePoints = Math.max(0, lovePoints + points);
            lovePointsElement.textContent = lovePoints;
            
            // æŒ‡æ•°å˜åŒ–åŠ¨ç”»
            lovePointsElement.style.animation = 'none';
            void lovePointsElement.offsetWidth; // è§¦å‘é‡ç»˜
            lovePointsElement.style.animation = 'glow 1.5s ease-in-out infinite alternate';
        }
        
        // åˆ›å»ºçˆ±å¿ƒé›¨æ•ˆæœ
        function createHeartRain(count) {
            for (let i = 0; i < count; i++) {
                const heart = document.createElement('div');
                heart.classList.add('heart');
                
                // éšæœºå¤§å°
                const size = Math.random() * 20 + 10;
                heart.style.fontSize = `${size}px`;
                
                // éšæœºä½ç½®
                heart.style.left = `${Math.random() * 100}vw`;
                
                // éšæœºé¢œè‰²
                const colors = ['#ff6b81', '#ff9ff3', '#54a0ff', '#5f27cd', '#ffd700'];
                heart.style.color = colors[Math.floor(Math.random() * colors.length)];
                
                // éšæœºå»¶è¿Ÿå’ŒæŒç»­æ—¶é—´
                const delay = Math.random() * 5;
                const duration = Math.random() * 10 + 5;
                heart.style.animationDelay = `${delay}s`;
                heart.style.animationDuration = `${duration}s`;
                
                // éšæœºæ—‹è½¬
                heart.style.transform = `rotate(${Math.random() * 360}deg)`;
                
                // çˆ±å¿ƒç¬¦å·
                heart.textContent = 'â¤ï¸';
                
                document.body.appendChild(heart);
                
                // ç§»é™¤å…ƒç´ 
                setTimeout(() => {
                    document.body.removeChild(heart);
                }, (delay + duration) * 1000);
            }
        }
        
        // æ£€æŸ¥æˆå°±
        function checkAchievements() {
            const achievements = [
                { condition: plantedFlowers >= 5, title: 'èŠ±å›­åˆæˆ', description: 'ä½ å·²ç»ç§ä¸‹äº†5æœµçˆ±æƒ…ä¹‹èŠ±ï¼' },
                { condition: plantedFlowers >= 10, title: 'ç™¾èŠ±é½æ”¾', description: 'ä½ çš„èŠ±å›­å·²ç»æœ‰10æœµç¾ä¸½çš„èŠ±æœµäº†ï¼' },
                { condition: plantedFlowers >= 15, title: 'æµªæ¼«èŠ±å›­', description: 'ä½ çš„èŠ±å›­å……æ»¡äº†çˆ±çš„æ°”æ¯ï¼' },
                { condition: lovePoints >= 100, title: 'çˆ±æ»¡å¿ƒç”°', description: 'çˆ±æƒ…æŒ‡æ•°è¾¾åˆ°100ï¼' },
                { condition: lovePoints >= 200, title: 'æµ“æƒ…èœœæ„', description: 'çˆ±æƒ…æŒ‡æ•°è¾¾åˆ°200ï¼' },
                { condition: messageCount >= 3, title: 'ç”œè¨€èœœè¯­', description: 'ä½ ç•™ä¸‹äº†3æ¡çˆ±çš„ç•™è¨€ï¼' },
                { condition: messageCount >= 5, title: 'æƒ…è¯ç»µç»µ', description: 'ä½ ç•™ä¸‹äº†5æ¡çˆ±çš„ç•™è¨€ï¼' },
                { condition: plantedFlowers >= 20 && lovePoints >= 300, title: 'çˆ±æƒ…èŠ±å›­å¤§å¸ˆ', description: 'ä½ æ˜¯çœŸæ­£çš„çˆ±æƒ…èŠ±å›­å¤§å¸ˆï¼' }
            ];
            
            // æ£€æŸ¥æ˜¯å¦æœ‰æ–°æˆå°±è§£é”
            for (const achievement of achievements) {
                // ä½¿ç”¨localStorageè®°å½•å·²è§£é”çš„æˆå°±
                const achievementKey = `achievement_${achievement.title}`;
                if (achievement.condition && !localStorage.getItem(achievementKey)) {
                    // è®°å½•æˆå°±
                    localStorage.setItem(achievementKey, 'true');
                    
                    // æ˜¾ç¤ºæˆå°±å¼¹çª—
                    showAchievement(achievement.title, achievement.description);
                    
                    // åˆ›å»ºåº†ç¥æ•ˆæœ
                    createHeartRain(20);
                    break; // ä¸€æ¬¡åªæ˜¾ç¤ºä¸€ä¸ªæˆå°±
                }
            }
        }
        
        // æ˜¾ç¤ºæˆå°±å¼¹çª—
        function showAchievement(title, description) {
            achievementTitle.textContent = title;
            achievementDescription.textContent = description;
            achievementModal.style.display = 'block';
        }
        
        // å·¥å…·é€‰æ‹©å¤„ç†
        function handleToolSelection(event) {
            // ç§»é™¤æ‰€æœ‰å·¥å…·çš„activeçŠ¶æ€
            toolButtons.forEach(button => button.classList.remove('active'));
            
            // æ·»åŠ å½“å‰å·¥å…·çš„activeçŠ¶æ€
            event.currentTarget.classList.add('active');
            
            // æ›´æ–°å½“å‰å·¥å…·
            currentTool = event.currentTarget.id;
        }
        
        // è¾…åŠ©å‡½æ•°ï¼šåŠ æ·±é¢œè‰²
        function darkenColor(color, percent) {
            // ç§»é™¤å¯èƒ½çš„alphaé€šé“
            color = color.replace(/[\s\)]+$/, '').replace(/rgba?\(/, '').split(',')[0].trim();
            
            // å¦‚æœæ˜¯åå…­è¿›åˆ¶é¢œè‰²
            if (color.charAt(0) === '#') {
                let num = parseInt(color.slice(1), 16);
                let amt = Math.round(2.55 * percent);
                let R = (num >> 16) - amt;
                let G = (num >> 8 & 0x00FF) - amt;
                let B = (num & 0x0000FF) - amt;
                return '#' + (0x1000000 + (R < 255 ? R < 1 ? 0 : R : 255) * 0x10000 +
                  (G < 255 ? G < 1 ? 0 : G : 255) * 0x100 +
                  (B < 255 ? B < 1 ? 0 : B : 255)).toString(16).slice(1);
            }
            return color;
        }
        
        // äº‹ä»¶ç›‘å¬å™¨
        function initEventListeners() {
            // å·¥å…·é€‰æ‹©
            toolButtons.forEach(button => {
                button.addEventListener('click', handleToolSelection);
            });
            
            // é»˜è®¤é€‰æ‹©ç§æ¤å·¥å…·
            document.getElementById('plantFlower').classList.add('active');
            
            // æäº¤ç•™è¨€
            submitMessageButton.addEventListener('click', submitMessage);
            messageInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    submitMessage();
                }
            });
            
            // è¿”å›æŒ‰é’®
            backButton.addEventListener('click', () => {
                window.location.href = 'page1.html';
            });
            
            // å…³é—­æˆå°±å¼¹çª—
            achievementClose.addEventListener('click', () => {
                achievementModal.style.display = 'none';
            });
        }
        
        // åˆå§‹åŒ–åº”ç”¨
        function initApp() {
            initGarden();
            initEventListeners();
        }
        
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>